webpackJsonp([13],{280:function(t,e,i){var n=i(1)(i(350),i(351),!1,function(t){i(348)},null,null);t.exports=n.exports},348:function(t,e,i){var n=i(349);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(5)("55b509dc",n,!0,{})},349:function(t,e,i){(t.exports=i(3)(!1)).push([t.i,"#jw-editor{position:fixed;width:350px;height:300px;background-color:#2d3e4f;color:#fff;padding:10px}",""])},350:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(152),o=i.n(n),r=i(6),a=i(8);i.n(a);e.default={components:{DashboardLayout:o.a},data:function(){return{frameBody:!1,editType:0,currentSelector:!1,modification:{innerText:""},modifications:{},originalModifications:{},modificationsDirty:!1,injectedEditor:!1}},beforeMount:function(){jQuery.fn.extend({getPath:function(){var t=[];return this.each(function(e,i){for(var n,o=jQuery(i);o.length;){var r=o.get(0),a=r.localName;if(!a)break;a=a.toLowerCase();var d=o.parent();if(d.children(a).length>1)(e=d.children().index(r)+1)>0&&(a+=":nth-child("+e+")");n=a+(n?" > "+n:""),o=d}t.push(n)}),t.join(",")}})},mounted:function(){var t=this;r.a.get("/modifications").then(function(e){return t.modifications=JSON.parse(e.data.config)}).catch(function(t){return modifications=!0}),this.originalModifications=a.util.extend({},this.modifications),$(this.$refs.editorFrame).on("mouseout",function(){t.frameBody.find("#jw-rect").remove()}),this.$refs.editorFrame.onload=function(){t.frameBody=$(t.$refs.editorFrame.contentDocument.body),t.frameBody.ready(function(){$(document).on("keyup",function(e){27===e.keyCode&&t.clearEditing()}),t.frameBody.on("keyup",function(e){27===e.keyCode&&t.clearEditing()}),t.injectEditor(),t.frameBody.bind("mouseover mouseout",function(e){if(!t.currentElement){var i=e.target;t.addFrameRect(i)}}).click(function(e){if("jw-editor"!==e.target.parentElement.parentElement.parentElement.parentElement.id||"jw-editor"===e.target.id)return e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),t.currentElement=e.target,t.currentSelector=$(t.currentElement).getPath(),t.modifications.hasOwnProperty(t.currentSelector)||(t.modifications[t.currentSelector]=a.util.extend({},t.modification)),t.showEditor(),!1})}),t.addFrameStyles()}},methods:{injectEditor:function(){this.injectedEditor=this.$refs.editor.cloneNode("deep"),this.addEditorInputs(),this.frameBody.append(this.injectedEditor)},addEditorInputs:function(){var t=this,e=$(this.injectedEditor);this.innerHTMLTextarea=$("<textarea>",{style:"width: 100%;"}),this.innerHTMLTextarea.on("keyup",function(e){console.log("hello"),t.modifications[t.currentSelector].innerText=e.target.value,t.updateElementText(e)}),e.find("#innerHTMLPlaceholder").html(this.innerHTMLTextarea)},showEditor:function(){var t=$(this.injectedEditor);this.innerHTMLTextarea.val(this.currentElement.innerText),t.removeClass("hidden")},hideEditor:function(){$(this.injectedEditor).addClass("hidden")},splitHostname:function(){var t={},e=new RegExp("([a-z-0-9]{2,63}).([a-z.]{2,5})$").exec(window.location.hostname);return t.domain=e[1],t.type=e[2],t.subdomain=window.location.hostname.replace(t.domain+"."+t.type,"").slice(0,-1),t},saveModifications:function(){r.a.post("/modifications/save",{domain:this.splitHostname().subdomain,config:this.modifications})},clearEditing:function(){this.editType=0,this.currentElement=!1,this.hideEditor(),this.elementText=""},updateElementText:function(){this.currentElement.innerText=this.modifications[this.currentSelector].innerText},isTextElement:function(t){var e=t.nodeName;return-1!==["P","SPAN","H1","H2","H3","H4","H5","DIV"].indexOf(e)},showTextEdit:function(t){this.modifications[this.currentSelector].innerText=t.innerText,this.editType=1},getCoords:function(t){var e=0,i=0;do{e+=t.offsetLeft-t.scrollLeft,i+=t.offsetTop-t.scrollTop}while(t=t.offsetParent);return{left:e,top:i}},getSize:function(t){return{width:t.offsetWidth,height:t.offsetHeight}},createRect:function(t,e,i){var n=$("<div />");return n.css({position:"absolute",top:e.top,left:e.left,width:i.width,height:i.height,border:"2px solid red",zIndex:"9999",pointerEvents:"none"}),n.attr("id","jw-rect"),n},addFrameRect:function(t){var e=this.getCoords(t),i=this.getSize(t),n=this.createRect(t,e,i);this.frameBody.find("#jw-rect").remove(),this.frameBody.append(n)},addFrameStyles:function(){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href="/css/framed.css",this.frameBody.append(t)}},watch:{modifications:{handler:function(){this.modificationsDirty=Object.keys(this.modifications).join("")!==Object.keys(this.originalModifications).join("")},deep:!0}}}},351:function(t,e){t.exports={render:function(){var t=this.$createElement,e=this._self._c||t;return e("dashboard-layout",{attrs:{"full-width":!0}},[e("div",[e("div",{staticStyle:{width:"100%",height:"700px"}},[e("iframe",{ref:"editorFrame",staticClass:"col-md-12",staticStyle:{height:"100%",width:"100%",border:"none"},attrs:{src:"/"}})]),this._v(" "),e("div",[e("button",{staticClass:"btn btn-success",staticStyle:{position:"fixed",bottom:"10px",right:"10px"},on:{click:this.saveModifications}},[this._v("Save Modifications\n            ")])]),this._v(" "),e("div",{ref:"editor",staticClass:"hidden",attrs:{id:"jw-editor"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12"},[e("div",{attrs:{id:"innerHTMLPlaceholder"}})])])])])])},staticRenderFns:[]}}});